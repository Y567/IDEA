<!--Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE HTML>
<html lang="en">

<head>
	<title>云相册登录和注册</title>
	<!-- Meta tag Keywords -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="UTF-8"/>
	<link rel="icon" type="image/png" href="images/favicon.png">
	<meta name="keywords" content="Validate Login & Register Forms Responsive Widget,Login form widgets, Sign up Web forms , Login signup Responsive web form,Flat Pricing table,Flat Drop downs,Registration Forms,News letter Forms,Elements" />
	<script>
		addEventListener("load", function () {
			setTimeout(hideURLbar, 0);
		}, false);

		function hideURLbar() {
			window.scrollTo(0, 1);
		}
	</script>
	<!-- Meta tag Keywords -->

	<!-- css files -->
	<link rel="stylesheet" href="css/style.css" type="text/css" media="all" />
	<!-- Style-CSS -->
	<link href="css/font-awesome.min.css" rel="stylesheet">
	<!-- Font-Awesome-Icons-CSS -->
	<!-- //css files -->
	<!-- web-fonts -->

</head>

<body>

	<div>
		<h1 style="color: #3c3c3c;text-align: center">云相册</h1>
		<h2 style="color: #3c3c3c;text-align: center">这里记录你的开心和不开心</h2>
	</div>
	<!-- //title -->

	<!-- 登录注册部分 -->
	<div class="container-agille">
		<div class="formBox level-login">
			<!-- 这里隐藏了一个阴影 -->
			<!--<div class="box boxShaddow"></div>-->
			<div class="box loginBox">
				<h3>登录</h3>
				<!--显示错误信息-->
				<div id="loginMsg" style="color: darkred;text-align: center;"></div>
				<form id="loginForm" class="form" method="post">
					<div class="f_row-2">
						<input id="login_email" type="text" class="input-field" placeholder="请输入您注册的邮箱" name="email" required>
					</div>
					<div class="f_row-2 last">
						<input id="login_password" type="password" name="password" placeholder="请输入8~20位字母的密码" class="input-field" required>
					</div>
					<input class="submit-w3" type="submit" value="登录">
				</form>
			</div>

			<!-- 这里删除了模板的忘记密码的部分 -->

			<!-- 这里是注册部分 -->
			<div class="box registerBox wthree">
				<span class="reg_bg"></span>
				<h3>注册</h3>
				<!--显示错误信息-->
				<div id="registerMsg" style="color: darkred;text-align: center;"></div>
				<form id="registerForm" class="form" method="post">
					<div class="f_row-2">
						<input id="username" type="text" class="input-field" placeholder="请输入4~16位字母的用户名" name="username" required>
					</div>
					<div class="f_row-2">
						<input id="email" type="text" class="input-field" placeholder="请输入您的邮箱" name="email" required>
					</div>
					<div class="f_row-2 last">
						<input id="password" type="password" name="password" placeholder="请输入8~20位字母的密码" class="input-field" required>
					</div>
					<input class="submit-w3" type="submit" value="注册">
				</form>
			</div>
			<a class="regTag icon-add">
				<i class="fa fa-repeat" aria-hidden="true"></i>
			</a>
		</div>
	</div>
	<!-- //content -->

	<!-- copyright -->
	<div class="footer-w3ls">
		<h2> © 2020 All rights reserved | Made with love By
			<a href="#">Y567</a>
		</h2>
	</div>
	<!-- //copyright -->

	<!-- js files -->
	<!-- Jquery -->
	<script src="js/jquery-3.2.1.min.js"></script>
	<!-- //Jquery -->
	<!-- input fields js -->
	<script src="js/input-field.js"></script>
	<!-- //input fields js -->
	<!-- password-script -->
	<script>
		/*注册模块函数*/
		//1.验证用户名的填写规则
		function checkUsername(){
			//利用正则表达式验证,\w表示字母，{4，16}表示4~16之间
			var regx = /^\w{4,16}$/;
			//获取表单中的值
			var username = $("#username").val();
			//检验
			return regx.test(username);
		}

		//2.验证邮箱填写规则的正确性
		function checkEmail(){
			//利用正则表达式验证,\w表示字母，+表示至少出现一次 wlan10@sina.com
			var regx = /^\w+@\w+\.\w+$/;
			//获取表单中的值
			var email = $("#email").val();
			//检验
			return regx.test(email);
		}

		//3.验证密码的规则正确
		function checkPassword(){
			//利用正则表达式验证,\w表示字母,密码的长度为8到20位
			var regx = /^\w{8,20}$/;
			//获取表单中的值
			var password = $("#password").val();
			//检验
			return regx.test(password);
		}

		/*登陆模块*/
		function checkLoginEmail(){
			//利用正则表达式验证,\w表示字母，+表示至少出现一次 wlan10@sina.com
			var regx = /^\w+@\w+\.\w+$/;
			//获取表单中的值
			var email = $("#login_email").val();
			//检验
			return regx.test(email);
		}
		function checkLoginPassword(){
			//利用正则表达式验证,\w表示字母,密码的长度为8到20位
			var regx = /^\w{8,20}$/;
			//获取表单中的值
			var password = $("#login_password").val();
			//检验
			return regx.test(password);
		}

		/**
		 * 入口函数
		 */
		$(function () {
			//入口方法
			//这是注册模块
			$("#registerForm").submit(function () {
				//返回true则提交表单，否则不提交
				if(checkUsername() && checkEmail() && checkPassword()){
					//只要三者都通过才提交表单
					$.get("user/email",$(this).serialize(),function (data) {
						//回调函数
						if(data.flag){
							//说明注册成功,我们需要提醒用户邮箱的发送，只要点击邮件才能注册成功
							//提示信息
							$("#registerMsg").html("恭喜您注册成功！请点击邮件完成注册！");
						}
						else{
							//注册失败,如果注册失败，那么就说明邮箱已被注册
							$("#registerMsg").html(data.errorMsg);
						}
					});
				}
				//不提交页面也就不会刷新
				return false;
			});

			//这是登录模块
			$("#loginForm").submit(function () {
				//返回true则提交表单，否则不提交
				if(checkLoginEmail() && checkLoginPassword()){
					//只要二者都通过才提交表单
					$.get("user/login",$(this).serialize(),function (data) {
						//回调函数
						//登陆失败显示信息
						if(!data.flag){
							$("#loginMsg").html(data.errorMsg);
						}else{
							//登陆成功，就转到
							location.href = "home.html"
						}
					});
				}
				//不提交页面也就不会刷新
				return false;
			});
		});


		/**
		 * 注册模块失去焦点的事件
		 */
		//1.用户名失去焦点绑定函数
		$("#username").blur(function () {
			if(checkUsername()){
				$("#username").css("border","");
			}else{
				$("#username").css("border","1px solid red");
			}
		});
		//2.密码框失焦点
		$("#password").blur(function () {
			if(checkPassword()){
				$("#password").css("border","");
			}else{
				$("#password").css("border","1px solid red");
			}
		});
		//3.邮箱失去焦点
		$("#email").blur(function () {
			if(checkEmail()){
				$("#email").css("border","");
			}else{
				$("#email").css("border","1px solid red");
			}
		});

		/**
		 * 登录模块失去焦点事件
		 */
		//1.邮箱失去焦点
		$("#login_email").blur(function () {
			if(checkLoginEmail()){
				$("#login_email").css("border","");
			}else{
				$("#login_email").css("border","1px solid red");
			}
		});

		//2.密码框失焦点
		$("#login_password").blur(function () {
			if(checkLoginPassword()){
				$("#login_password").css("border","");
			}else{
				$("#login_password").css("border","1px solid red");
			}
		});

	</script>
	<!-- //password-script -->
	<!-- //js files -->
</body>

</html>